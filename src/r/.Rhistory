packrat::init(options = list(auto.snapshot = TRUE, vcs.ignore.src = TRUE))
packrat::set_opts(vcs.ignore.lib = FALSE, vcs.ignore.src = FALSE)
packrat::init(options = list(auto.snapshot = TRUE, vcs.ignore.src = TRUE))
install.packages(c('tidyverse', 'anomalize', 'prophet'))
install.packages(c('tidyverse', 'anomalize', 'prophet', 'IRkernel'))
library(tidyverse)
library(anomalize)
library(tidyverse)
library(anomalize)
library(tidyverse)
library(anomalize)
getwd()
tb = read_csv("../../data/NYCHA_TS.csv")
tb = select(tb, c('Building_Meter', 'Month', 'Imputed_KWH'))
tb
ts =  select(filter(tb, Building_Meter == '165.0 - BLD 03_90327795'), 'Building_Meter', 'Month', 'Imputed_KWH')
ts_anomalized <- ts %>%
time_decompose(Imputed_KWH, merge = TRUE) %>%
anomalize(remainder) %>%
time_recompose()
ts_anomalized
trace("plot_anomaly_decomposition",edit=TRUE)
trace("plot_anomaly_decomposition",edit=TRUE)
p1 <- ts_anomalized %>%
plot_anomaly_decomposition(alpha_dot = 0.5) +
ggtitle("Freq/Trend = 'auto'")
p1
trace("plot_anomaly_decomposition",edit=TRUE)
p1 <- ts_anomalized %>%
plot_anomaly_decomposition(alpha_dot = 0.5) +
ggtitle("Freq/Trend = 'auto'")
p1
.libPaths()
lapply(.libPaths(), dir)
?time_decompose
?anomalize
# Generate anomalies
set.seed(100)
x <- rnorm(100)
idx_outliers    <- sample(100, size = 5)
x[idx_outliers] <- x[idx_outliers] + 10
# Visualize simulated anomalies
qplot(1:length(x), x,
main = "Simulated Anomalies",
xlab = "Index")
iqr_outliers <- iqr(x, alpha = 0.05, max_anoms = 0.2, verbose = TRUE)$outlier_report
gesd_outliers <- gesd(x, alpha = 0.05, max_anoms = 0.2, verbose = TRUE)$outlier_report
iqr_outliers
gesd_outliers
ggsetup <- function(data) {
data %>%
ggplot(aes(rank, value, color = outlier)) +
geom_point() +
geom_line(aes(y = limit_upper), color = "red", linetype = 2) +
geom_line(aes(y = limit_lower), color = "red", linetype = 2) +
geom_text(aes(label = index), vjust = -1.25) +
theme_bw() +
scale_color_manual(values = c("No" = "#2c3e50", "Yes" = "#e31a1c")) +
expand_limits(y = 13) +
theme(legend.position = "bottom")
}
p3 <- iqr_outliers %>%
ggsetup() +
ggtitle("IQR: Top outlers sorted by rank")
p4 <- gesd_outliers %>%
ggsetup() +
ggtitle("GESD: Top outlers sorted by rank")
p3
p4
?anormalize
?anomalize
gesd_outliers
?`anomalize_package-package`
??anomalize
?anomalize
